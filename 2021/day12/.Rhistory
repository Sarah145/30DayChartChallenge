scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_blend(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
bg_layer = wave,
blend_type = 'copy_green',
alpha = 'src'
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_blend(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
bg_layer = wave,
blend_type = 'copy_red',
alpha = 'src'
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_blend(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
id = 'text',
blend_type = 'copy_red',
alpha = 'src'
) +
with_blend(
geom_density_2d_filled(aes(rnorm(1e4, 0.5, 0.2), rnorm(1e4, 0.5, 0.2)),
show.legend = FALSE),
bg_layer = "text",
blend_type = "in",
id = "blended"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_blend(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
id = 'text',
blend_type = 'copy_red',
alpha = 'src'
) +
with_blend(
geom_density_2d_filled(aes(rnorm(1e4, 0.5, 0.2), rnorm(1e4, 0.5, 0.2)),
show.legend = FALSE, inherit.aes = F),
bg_layer = "text",
blend_type = "in",
id = "blended"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_blend(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
id = 'text',
blend_type = 'copy_red',
alpha = 'src'
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_displacement(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
id = 'text',
blend_type = 'copy_red',
alpha = 'src'
) +
with_blend(
geom_density_2d_filled(aes(rnorm(1e4, 0.5, 0.2), rnorm(1e4, 0.5, 0.2)),
show.legend = FALSE, inherit.aes = F),
bg_layer = "text",
blend_type = "in",
id = "blended"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_displacement(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
id = 'text',
blend_type = 'copy_red',
alpha = 'src'
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
with_displacement(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
x_map = ch_red("displace_map"),
y_map = ch_blue("displace_map"),
x_scale = unit(0.025, 'npc'),
id = "text"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
as_reference(
geom_polygon(aes(c(0, 1, 1), c(0, 0, 1)), colour = NA, fill = 'magenta'),
id = "displace_map"
) +
geom_col(position = 'fill', show.legend = F) +
with_displacement(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
x_map = ch_red("displace_map"),
y_map = ch_blue("displace_map"),
x_scale = unit(0.025, 'npc'),
id = "text"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
as_reference(
geom_col(position = 'fill', show.legend = F) +
id = "displace_map"
) +
with_displacement(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
x_map = ch_red("displace_map"),
y_map = ch_blue("displace_map"),
x_scale = unit(0.025, 'npc'),
id = "text"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
as_reference(
geom_col(position = 'fill', show.legend = F),
id = "displace_map"
) +
with_displacement(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
x_map = ch_red("displace_map"),
y_map = ch_blue("displace_map"),
x_scale = unit(0.025, 'npc'),
id = "text"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
as_reference(
geom_col(position = 'fill', show.legend = F),
id = "displace_map"
) +
with_displacement(
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10),
x_map = ch_red("displace_map"),
y_map = ch_blue("displace_map"),
x_scale = unit(0.025, 'npc'),
id = "text"
) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10)) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The Distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggsave('~/Documents/30DayChartChallenge/strips.png', dpi = 500)
52+39
df <- df %>%
rownames_to_column() %>%
filter(keep == 'True') %>%
mutate(timepoint = case_when(
timepoint == 'TRT' ~ 'TRT (ex vivo)',
str_detect(timepoint, 'D[1-9]') ~ 'TRT (in vivo)',
timepoint == 'R' ~ 'Relapse',
timepoint == 'nan' ~ 'Healthy',
timepoint == 'D0' ~ 'Diagnosis'
),
donor_status = ifelse(timepoint == 'Healthy', 'Healthy', 'AML'),
ct = case_when(
str_detect(celltype1, 'CD14.Mono') ~ 'CD14.Mono',
str_detect(celltype1, 'CD8.[EC]M') ~ 'CD8.M',
str_detect(celltype1, 'CD4.N') ~ 'CD4.N',
str_detect(celltype1, 'GMP') ~ 'GMP',
str_detect(celltype1, 'CLP') ~ 'CLP',
celltype1 %in% c('Megakaryocyte.Prog', 'Early.Eryth', 'Early.Baso') ~ 'MEP',
celltype1 %in% c('HSC', 'CMP.LMPP') ~ 'HSC.MPP',
T ~ celltype1
))
df <- read.csv('~/Documents/Project/bone_marrow_analysis/data/integrated_umap.csv', sep = '\t', row.names = 1)
df <- df %>%
rownames_to_column() %>%
filter(keep == 'True') %>%
mutate(timepoint = case_when(
timepoint == 'TRT' ~ 'TRT (ex vivo)',
str_detect(timepoint, 'D[1-9]') ~ 'TRT (in vivo)',
timepoint == 'R' ~ 'Relapse',
timepoint == 'nan' ~ 'Healthy',
timepoint == 'D0' ~ 'Diagnosis'
),
donor_status = ifelse(timepoint == 'Healthy', 'Healthy', 'AML'),
ct = case_when(
str_detect(celltype1, 'CD14.Mono') ~ 'CD14.Mono',
str_detect(celltype1, 'CD8.[EC]M') ~ 'CD8.M',
str_detect(celltype1, 'CD4.N') ~ 'CD4.N',
str_detect(celltype1, 'GMP') ~ 'GMP',
str_detect(celltype1, 'CLP') ~ 'CLP',
celltype1 %in% c('Megakaryocyte.Prog', 'Early.Eryth', 'Early.Baso') ~ 'MEP',
celltype1 %in% c('HSC', 'CMP.LMPP') ~ 'HSC.MPP',
T ~ celltype1
))
cell_cols <- c(Plasma = '#333333', CLP = '#B2EF9B', Pre.B = '#3A7219', B = '#1b360c',
HSC.MPP = '#f7d760', MEP = '#B84F09', Late.Eryth = '#6D2F05', Megakaryocytes = '#f7a660',
GMP = '#DE9197', CD14.Mono = '#AD343E', CD16.Mono = '#bd0000',
cDC ='#ff0378', pDC = '#fc5e03',
CD4.N = '#015073', CD4.M = '#96CBFE',
CD8.N = '#16b8b2', CD8.M = '#946CD5', NK = '#4D1282',
Mesenchymal = '#702127')
df$ct <- factor(df$ct, levels = names(cell_cols))
dataset_cols <- PNWColors::pnw_palette('Sunset2', 5)
names(dataset_cols) <- unique(df$dataset)
donor_cols <- ggcute:::sugarpill_pal()(57)
names(donor_cols) <- unique(df$donor)
timepoint_cols <- c(Healthy = '#D7F2BA', Diagnosis = '#FFC15E', `TRT (ex vivo)` = '#97DFFC',
`TRT (in vivo)` = '#A188A6', Relapse = '#FF6B6B')
nrow(df)
df <- get_colors('~/Downloads/IMG_7511.JPG')
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggsave('~/Documents/30DayChartChallenge/strips.png', dpi = 500)
library(tidyverse)
setwd('~/Documents/30DayChartChallenge/day12')
library(tidyverse)
library(colorfindr)
df <- get_colors('IMG_7511.JPG', top_n = 2000)
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggsave('12-strips.png', dpi = 500)
nrow(df)
df <- get_colors('IMG_7511.JPG')
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggsave('12-strips.png', dpi = 500)
ggsave('12-strips.png', dpi = 500)
ggsave('12-strips.png', dpi = 500)
p <- ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
rasterImage(p)
?ggsave
ggsave(p, '12-strips.png', dpi = 500)
ggsave('12-strips.png', p, dpi = 500)
ragg::agg_png('12-strips.png', dpi = 500)
ragg::agg_png('12-strips.png')
getwd()
ggsave('12-strips.png', dpi = 500)
ggplot(df, aes(x = 0, y = col_share, fill = col_hex)) +
geom_col(position = 'fill', show.legend = F) +
geom_text(data = data.frame(x = 0, y = 0.5,
label = 'The distribution (and lack) of colour\nin my wardrobe'),
aes(x=x,y=y,label=label), inherit.aes = F, col = 'white', size = 10) +
scale_fill_identity() +
scale_x_continuous(expand = c(0,0)) +
scale_y_reverse(expand = c(0,0)) +
theme_void() +
theme(panel.background = element_blank(),
plot.background = element_blank(),
plot.margin = margin(0,0,0,0)) +
coord_flip()
ggsave('12-strips.png', dpi = 800)
ggsave('12-strips.png', dpi = 800, width = 10, height = 6)
library(shiny)
runApp('~/Documents/staRchart/')
runApp('~/Documents/staRchart/')
library(datapasta)
tibble::tribble(
~Country.name, ~PhD.income, ~Minimum.wage, ~`salary/min_wage`,
"Ireland",        1333,          1574,       0.8468869123,
"United Kingdom",        1395,          1220,        1.143442623,
"Spain",        1307,          1002,        1.304391218,
"France",        1758,          1324,        1.327794562,
"Luxembourg",        2835,          1808,        1.568030973,
"Netherlands",        2395,          1489,        1.608462055,
"Portugal",         920,           571,        1.611208406,
"Germany",        2001,          1168,        1.713184932,
"Belgium",        2373,          1216,        1.951480263
)
df <- tibble::tribble(
~Country.name, ~PhD.income, ~Minimum.wage, ~`salary/min_wage`,
"Ireland",        1333,          1574,       0.8468869123,
"United Kingdom",        1395,          1220,        1.143442623,
"Spain",        1307,          1002,        1.304391218,
"France",        1758,          1324,        1.327794562,
"Luxembourg",        2835,          1808,        1.568030973,
"Netherlands",        2395,          1489,        1.608462055,
"Portugal",         920,           571,        1.611208406,
"Germany",        2001,          1168,        1.713184932,
"Belgium",        2373,          1216,        1.951480263
)
ggplot(df, aes(x=PhD.income, y=Minimum.wage, col=Country.name)) + geom_point()
ggplot(df, aes(x=Minimum.wage, y=PhD.income, col=Country.name)) + geom_point()
ggplot(df, aes(x=Minimum.wage, y=PhD.income, col=Country.name)) + geom_point() + geom_line(x=y)
ggplot(df, aes(x=Minimum.wage, y=PhD.income, col=Country.name)) + geom_point() + geom_abline(intercept = 500, slope = 1)
ggplot(df, aes(x=Minimum.wage, y=PhD.income, col=Country.name)) + geom_point() + geom_abline(intercept = 500, slope = 1) +scale_x_continuous(limits = c(500, 2500)) + scale_y_continuous(limits = c(500, 2500))
ggplot(df, aes(x=Minimum.wage, y=PhD.income, col=Country.name)) + geom_point() + geom_abline(intercept = 500, slope = 1) +scale_x_continuous(limits = c(500, 3000)) + scale_y_continuous(limits = c(500, 3000))
ggplot(df, aes(x=Minimum.wage, y=PhD.income, col=Country.name)) + geom_point() + geom_abline(intercept = 0, slope = 1) +scale_x_continuous(limits = c(500, 3000)) + scale_y_continuous(limits = c(500, 3000))
cor(df$PhD.income, df$Minimum.wage)
d <- read.csv('~/Downloads/GSE135194_countExpression_newID.csv.gz')
d[1:4,1:4]
ncol(d)
nrow(d)
colnames(d[,c(34391)])
colnames(d[,34391])
colnames(d)[34391]
healthy_donors <- str_detect(colnames(d), 'HD')
healthy_mat <- d[,healthy_donors]
ncol(healthy_mat)
rownames(healthy_mat) <- d[,1]
healthy_mat[1:4,1:4]
h <- str_extract(colnames(healthy_mat), 'HD[0-9]')
unique(h)
healthy_m <- as.matrix(healthy_mat)
healthy_m[1:4,1:4]
Matrix::writeMM(healthy_m, '~/Documents/Project/bone_marrow_analysis/data/wu2.mtx')
library(Matrix)
healthy_m <- sparseMatrix(healthy_mat)
healthy_m <- as.matrix(healthy_mat, sparse = T)
head(healthy_m)
Matrix::writeMM(healthy_m, '~/Documents/Project/bone_marrow_analysis/data/wu2.mtx')
healthy_m <- Matrix(healthy_mat, sparse = T)
healthy_m <- Matrix(healthy_m, sparse = T)
Matrix::writeMM(healthy_m, '~/Documents/Project/bone_marrow_analysis/data/wu2.mtx')
head(healthy_m)
